<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inventory</title>
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="/bootstrap-icons/font/bootstrap-icons.min.css"
    />
    <link
      rel="stylesheet"
      href="/datatables.net-dt/css/dataTables.dataTables.css"
    />
    <script src="/jquery/jquery.min.js"></script>
    <script src="/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- DataTables and ColReorder from CDN, matching version -->
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css"
    />
    <!-- <link
      rel="stylesheet"
      href="https://cdn.datatables.net/colreorder/1.5.0/css/colReorder.dataTables.min.css"
    /> -->

    <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
    <!-- <script src="https://cdn.datatables.net/colreorder/1.5.0/js/dataTables.colReorder.min.js"></script> -->

    <!-- Buttons Extension -->
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css"
    />
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>

    <!-- Dependencies for PDF/Excel export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="/js/print-utils.js"></script>
    <script src="inventory.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <link rel="stylesheet" href="inventory.css" />
  </head>

  <body>
    <div class="card shadow-lg rounded p-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">INVENTORY</h2>
        <button
          class="btn btn-warning btn-sm add-item"
          data-bs-toggle="modal"
          data-bs-target="#addItem"
        >
          Add Item
        </button>
      </div>

      <div class="container mt-5">
        <div class="row mb-3 justify-content-center">
          <div class="row mb-3">
            <!-- Left side -->
            <div class="col-md-5 d-flex align-items-center">
              <label for="item" class="col-sm-4 col-form-label">Item:</label>
              <div class="col-sm-8">
                <input
                  type="item"
                  class="form-control criteria"
                  id="itemSearch"
                  name="item"
                  tabindex="1"
                />
              </div>
            </div>

            <!-- Right side -->
            <div class="col-md-5 d-flex align-items-center">
              <label for="status" class="col-sm-4 col-form-label"
                >Item Status</label
              >
              <div class="col-sm-8">
                <select
                  class="form-select criteria"
                  id="ItemStatus"
                  name="status"
                >
                  <option selected value="">Select a Status</option>
                  <option value="In Stock">In Stock</option>
                  <option value="For Reorder">For Reorder</option>
                  <option value="Out of Stock">Out of Stock</option>
                </select>
              </div>
            </div>

            <div class="col-md-2 d-flex align-items-center gap-1">
              <button
                type="button"
                class="btn btn-info btn-sm"
                onclick="clearCriteria()"
              >
                Clear
              </button>
              <button
                type="button"
                class="btn btn-success btn-sm"
                onclick="searchInventory()"
              >
                Search
              </button>
              <button
                type="button"
                class="btn btn-secondary btn-sm"
                onclick="printInventory()"
                title="Print Inventory"
              >
                <i class="bi bi-printer"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="table-responsive">
        <table
          id="inventoryTable"
          class="table table-striped table-bordered table-hover"
        >
          <thead>
            <tr>
              <th>ID</th>
              <th>Item</th>
              <th>Category</th>
              <th>Unit</th>
              <th>(A) Beginning Balance</th>
              <th>(B) Adjustments (+/-)</th>
              <th>(C) Total Available</th>
              <th>(D) Actual Stock</th>
              <th>(E) Qty Used</th>
              <th>(F) Qty Wasted</th>
              <th>(G) Months Usage</th>
              <th>(H) ABL</th>
              <th>(I) Qty Required</th>
              <th>(J) Stock</th>
              <th>(K) Ending Balance</th>
              <th>Price</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
        </table>
      </div>

    </div>
  </body>
  <!-- ADD ITEM Modal -->
  <div
    class="modal fade"
    id="addItem"
    tabindex="-1"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Add Item</h1>
          <input type="hidden" id="modal_user_id" />
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>

        <div class="modal-body">
          <div class="container mt-4">
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addItem" class="col-sm-4 col-form-label">Item:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="addItem2" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addCategory" class="col-sm-4 col-form-label"
                >Category:</label
              >
              <div class="col-sm-8">
                <select class="form-select criteria" id="addCategory">
                  <option selected value="">Select...</option>
                  <option value="1">Medicines / Pharmaceuticals</option>
                  <option value="2">Personal Protective Equipment (PPE)</option>
                  <option value="3">Medical Instruments / Tools</option>
                  <option value="4">Consumables / Disposables</option>
                  <option value="5">Contraceptives</option>
                </select>
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addUnit" class="col-sm-4 col-form-label"
                >Unit:</label
              >
              <div class="col-sm-8">
                <input type="text" class="form-control" id="addUnit" placeholder="e.g., Tube, Piece, Box" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addBeginningBalance" class="col-sm-4 col-form-label"
                >Beginning Balance:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="addBeginningBalance" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addAdjustments" class="col-sm-4 col-form-label"
                >Adjustments (+/-):</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="addAdjustments" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addActualStock" class="col-sm-4 col-form-label"
                >Actual Stock:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="addActualStock" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addQtyWasted" class="col-sm-4 col-form-label"
                >Qty Wasted:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="addQtyWasted" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addMonthsUsage" class="col-sm-4 col-form-label"
                >Months Usage:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="addMonthsUsage" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addABL" class="col-sm-4 col-form-label"
                >ABL:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="addABL" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="addPrice" class="col-sm-4 col-form-label"
                >Price:
              </label>
              <div class="col-sm-8">
                <input
                  type="number"
                  class="form-control"
                  id="addPrice"
                  placeholder="₱"
                />
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="discardChanges()">Discard</button>
          <button type="button" class="btn btn-primary" onclick="saveItem()">
            Save Item
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- UPDATE ITEM Modal -->
  <div
    class="modal fade"
    id="updateItem"
    tabindex="-1"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Update Item</h1>
          <input type="hidden" id="modal_user_id" />
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>

        <div class="modal-body">
          <div class="container mt-4">
            <input type="hidden" class="form-control" id="updateID" />
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateItem" class="col-sm-4 col-form-label"
                >Item:</label
              >
              <div class="col-sm-8">
                <input type="text" class="form-control" id="updateItemName" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateCategory" class="col-sm-4 col-form-label"
                >Category:</label
              >
              <div class="col-sm-8">
                <select class="form-select criteria" id="updateCategory">
                  <option selected value="">Select...</option>
                  <option value="1">Medicines / Pharmaceuticals</option>
                  <option value="2">Personal Protective Equipment (PPE)</option>
                  <option value="3">Medical Instruments / Tools</option>
                  <option value="4">Consumables / Disposables</option>
                  <option value="5">Contraceptives</option>
                </select>
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateUnit" class="col-sm-4 col-form-label"
                >Unit:</label
              >
              <div class="col-sm-8">
                <input type="text" class="form-control" id="updateUnit" placeholder="e.g., Tube, Piece, Box" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateBeginningBalance" class="col-sm-4 col-form-label"
                >Beginning Balance:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="updateBeginningBalance" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateAdjustments" class="col-sm-4 col-form-label"
                >Adjustments (+/-):</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="updateAdjustments" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateActualStock" class="col-sm-4 col-form-label"
                >Actual Stock:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="updateActualStock" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateQtyUsed" class="col-sm-4 col-form-label"
                >Qty Used:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="updateQtyUsed" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateQtyWasted" class="col-sm-4 col-form-label"
                >Qty Wasted:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="updateQtyWasted" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateMonthsUsage" class="col-sm-4 col-form-label"
                >Months Usage:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="updateMonthsUsage" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updateABL" class="col-sm-4 col-form-label"
                >ABL:</label
              >
              <div class="col-sm-8">
                <input type="number" class="form-control" id="updateABL" />
              </div>
            </div>
            <div class="col-md-10 d-flex align-items-center mb-2">
              <label for="updatePrice" class="col-sm-4 col-form-label"
                >Price:
              </label>
              <div class="col-sm-8">
                <input
                  type="number"
                  class="form-control"
                  id="updatePrice"
                  placeholder="₱"
                />
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="discardChanges()">Discard</button>
          <button type="button" class="btn btn-primary" onclick="updateItem()">
            Update Item
          </button>
        </div>
      </div>
    </div>
  </div>
</html>
